<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create New Model</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        input[type="text"], input[type="file"], textarea, select { width: 100%; padding: 8px; box-sizing: border-box; }
        button { padding: 10px 15px; background-color: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        .dynamic-list { margin-top: 10px; }
        .dynamic-item { display: flex; gap: 10px; margin-bottom: 10px; }
        .remove-btn { background-color: #dc3545; }
    </style>
</head>
<body>
<h1>Create New Model</h1>

<div class="form-group">
    <label for="pool_id">Pool ID *</label>
    <input type="text" id="pool_id" value="8bd16d45-056d-5590-bc7f-12849f034351" name="pool_id" required pattern="[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}">
</div>

<form id="modelForm">
    <div class="form-group">
        <label for="product">Product *</label>
        <input type="text" id="product" name="product" required>
    </div>
    <div class="form-group">
        <label for="version">Version</label>
        <input type="text" id="version" name="version">
    </div>
    <div class="form-group">
        <label for="manufacturer">Manufacturer</label>
        <input type="text" id="manufacturer" name="manufacturer">
    </div>
    <div class="form-group">
        <label for="description">Description</label>
        <textarea id="description" name="description"></textarea>
    </div>
    <div class="form-group">
        <label for="technicalDetails">Technical Details</label>
        <textarea id="technicalDetails" name="technicalDetails"></textarea>
    </div>
    <div class="form-group">
        <label for="internalDescription">Internal Description</label>
        <textarea id="internalDescription" name="internalDescription"></textarea>
    </div>
    <div class="form-group">
        <label>Properties</label>
        <div id="propertiesList" class="dynamic-list"></div>
        <button type="button" id="addProperty">Add Property</button>
    </div>
    <div class="form-group">
        <label for="images">Images</label>
        <input type="file" id="images" name="images" multiple accept="image/*">
    </div>
    <div class="form-group">
        <label for="attachments">Attachments</label>
        <input type="file" id="attachments" name="attachments" multiple>
    </div>
    <div class="form-group">
        <label>
            <input type="checkbox" id="isPackage" name="isPackage">
            This is a package
        </label>
    </div>

    <div class="form-group">
        <label>Accessories</label>
        <div id="accessoriesList" class="dynamic-list"></div>
        <button type="button" id="addAccessory">Add Accessory</button>
    </div>
    <div class="form-group">
        <button type="submit">Save Model</button>
    </div>
</form>

<script>
    $(document).ready(function() {
        // Add Property
        $('#addProperty').click(function() {
            $('#propertiesList').append(`
                    <div class="dynamic-item">
                        <input type="text" name="propertyKey[]" placeholder="Key" required>
                        <input type="text" name="propertyValue[]" placeholder="Value" required>
                        <button type="button" class="remove-btn">Remove</button>
                    </div>
                `);
        });

        // Add Accessory
        $('#addAccessory').click(function() {
            $('#accessoriesList').append(`
                    <div class="dynamic-item">
                        <input type="text" name="accessoryName[]" placeholder="Accessory name" required>
                        <label>
                            <input type="checkbox" name="accessoryInventory[]">
                            In inventory
                        </label>
                        <button type="button" class="remove-btn">Remove</button>
                    </div>
                `);
        });

        // Remove dynamic item
        $(document).on('click', '.remove-btn', function() {
            $(this).parent().remove();
        });

        // Form submission
        $('#modelForm').submit(function(e) {
            e.preventDefault();
            var formData = new FormData(this);

            // Prepare properties
            var properties = [];
            $('input[name="propertyKey[]"]').each(function(index) {
                properties.push({
                    key: $(this).val(),
                    value: $('input[name="propertyValue[]"]').eq(index).val()
                });
            });
            formData.append('properties', JSON.stringify(properties));

            // Prepare accessories
            var accessories = [];
            $('input[name="accessoryName[]"]').each(function(index) {
                accessories.push({
                    name: $(this).val(),
                    inventory_bool: $('input[name="accessoryInventory[]"]').eq(index).is(':checked')
                });
            });
            formData.append('accessories', JSON.stringify(accessories));

            // Send form data to API
            $.ajax({
                url: 'http://localhost:3260/inventory/8bd16d45-056d-5590-bc7f-12849f034351/model', // Replace with your API endpoint
                method: 'POST',

                data: formData,
                processData: false,
                contentType: false,
                headers: {
                    'Accept': 'application/json'
                },
                success: function(response) {
                    alert('Model created successfully!');
                    // Handle success (e.g., redirect or clear form)
                },
                error: function(xhr, status, error) {
                    alert('Error creating model: ' + error);
                    // Handle error
                }
            });
        });
    });
</script>
</body>
</html>